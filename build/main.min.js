$(document).ready(function(){function b(){$("#change-mode").data("mode","view"),$(".metric").removeClass("edit-metric"),d(!1)}function c(){$("#change-mode").data("mode","edit"),$(".metric").not(".new-metric").addClass("edit-metric"),d(!0)}function d(b){b?($(document).on("click",".metric-title",e),$("#change-mode").addClass("active").html("EXIT EDITION MODE"),$(".edit-metric").each(function(){$(this).append('<a class="js-delete-metric"><span class="fa fa-times"></span></a>'),$(this).children(".metric-title").after('<span class="fa fa-pencil editable-name"></span>')})):($(document).off("click",".metric-title"),$("#change-mode").removeClass("active").html('<span class="fa fa-pencil"></span>'),$("a.js-delete-metric").remove(),$(".editable-name").remove()),i(a)}function e(a){var b=a.currentTarget||a,c=$(b).text();$(".editable-name").remove(),$(b).replaceWith('<input class="metric-title input-metric-title">'),$(".input-metric-title").val(c).focus(),$(".input-metric-title").focusout(function(){var a=""==$(this).val()?c:$(this).val();$(this).replaceWith('<h3 class="metric-title">'+a+"</h3>"),"view"!=$("#change-mode").data("mode")&&$(".metric-title").after('<span class="fa fa-pencil editable-name"></span>')}),$(".input-metric-title").keyup(function(a){13==a.keyCode&&$(".input-metric-title").focusout(),27==a.keyCode&&$(".input-metric-title").val(c).focusout()})}function f(){$(this).parent(".metric").remove()}function g(){var a=$('<article class="metric"></article>'),b=$('<h3 class="metric-title">Metric name</h3>'),c=h();a.append(b),$(".new-metric").before(a),e(b),a.append(c)}function h(){var a=Math.floor(3*Math.random()),b="";switch(a){case 0:b+="<span>Limit X reached</span>";case 1:b+="<span>162 updates</span>";case 2:b+="<span>Monthly resolution</span>"}return $('<div class="details">'+b+"</div>")}function i(a){var b=$(".content").width()-$("#change-mode").width()-90;$(".name-account").text(a).widthTruncate({width:b})}$("#change-mode").click(function(){var a=$(this).data("mode");"view"==a?c():b()});var a=$(".name-account").text();i(a),$(".metric").not(".new-metric").each(function(){$(this).append(h())}),$(document).on("click",".js-delete-metric",f),$(document).on("click",".new-metric",g)}),function(a){a.fn.extend({widthTruncate:function(b){var c={width:"auto",after:"..."},b=a.extend(c,b);return this.each(function(){if(truncateWidth="auto"==b.width?a(this).width()-8:b.width,a(this).width()>truncateWidth){var c=a(this).text();for(a(this).html('<span id="truncateWrapper" style="display:inline;">'+b.after+"</div>"),i=1;a("#truncateWrapper").width()<truncateWidth;)a("#truncateWrapper").html(c.substr(0,i)+b.after),i++;a(this).html(a("#truncateWrapper").html())}})}})}(jQuery);